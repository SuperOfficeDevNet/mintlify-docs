---
uid: crmscript.netserver.nsquote
title: NSQuote
description: "Quote carrier with the active quote version and favorite alternative."
keywords: CRMScript, NSQuote, API reference
author: SuperOffice Product and Engineering
date: 01.08.2026
version: 11.7
content_type: reference
language: en
---

# NSQuote

Quote carrier with the active quote version and favorite alternative.

## Constructors

### NSQuote()

```crmscript
NSQuote
```

Initializes a new instance of the NSQuote class.

## Methods

## GetAcceptedQuoteAlternativeId()

```crmscript
Integer GetAcceptedQuoteAlternativeId()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - The primary key of the Quote Alternative which was finally accepted by the customer.

<Note>
Set when the user is marking a quote as accepted.
</Note>

**Example:**

```crmscript
NSQuote thing;
Integer acceptedQuoteAlternativeId = thing.GetAcceptedQuoteAlternativeId();
```

## GetActiveQuoteVersion()

```crmscript
NSQuoteVersion GetActiveQuoteVersion()
```

**Returns:** [CRMScript.NetServer.NSQuoteVersion](CRMScript.NetServer.NSQuoteVersion) - The active quote version for the quote.

**Example:**

```crmscript
NSQuote thing;
NSQuoteVersion activeQuoteVersion = thing.GetActiveQuoteVersion();
```

## GetActiveQuoteVersionId()

```crmscript
Integer GetActiveQuoteVersionId()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - The primary key of the Quote Version that is currently active.

<Note>
The active version will always be the latest version.
</Note>

**Example:**

```crmscript
NSQuote thing;
Integer activeQuoteVersionId = thing.GetActiveQuoteVersionId();
```

## GetDocumentId()

```crmscript
Integer GetDocumentId()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - The ID of the main Quote Document.

**Example:**

```crmscript
NSQuote thing;
Integer documentId = thing.GetDocumentId();
```

## GetERPOrderKey()

```crmscript
String GetERPOrderKey()
```

**Returns:** [CRMScript.Global.String](CRMScript.Global.String) - The key in the ERP system that identifies this sale's Order, as transferred and possibly later edited in the ERP system.

<Note>
Only filled out if there exists a corresponding order representation of the quote in the ERP system.
</Note>

**Example:**

```crmscript
NSQuote thing;
String eRPOrderKey = thing.GetERPOrderKey();
```

## GetERPQuoteKey()

```crmscript
String GetERPQuoteKey()
```

**Returns:** [CRMScript.Global.String](CRMScript.Global.String) - Foreign key of quote (if available). The key in the ERP system that identifies this sale's Quote (as opposed to the later Order information).

**Example:**

```crmscript
NSQuote thing;
String eRPQuoteKey = thing.GetERPQuoteKey();
```

## GetFavoriteQuoteAlternative()

```crmscript
NSQuoteAlternative GetFavoriteQuoteAlternative()
```

**Returns:** [CRMScript.NetServer.NSQuoteAlternative](CRMScript.NetServer.NSQuoteAlternative) - The favorite quote alternative for the quote and active quote version.

**Example:**

```crmscript
NSQuote thing;
NSQuoteAlternative favoriteQuoteAlternative = thing.GetFavoriteQuoteAlternative();
```

## GetOrderComment()

```crmscript
String GetOrderComment()
```

**Returns:** [CRMScript.Global.String](CRMScript.Global.String) - A comment that is intended for the Invoice, Order, Packing list and similar stages AFTER the quote has become an order and goes to ERP for processing.

**Example:**

```crmscript
NSQuote thing;
String orderComment = thing.GetOrderComment();
```

## GetPoNumber()

```crmscript
String GetPoNumber()
```

**Returns:** [CRMScript.Global.String](CRMScript.Global.String) - Customer's Purchase order number.

**Example:**

```crmscript
NSQuote thing;
String poNumber = thing.GetPoNumber();
```

## GetPreferredEmailCulture()

```crmscript
String GetPreferredEmailCulture()
```

**Returns:** [CRMScript.Global.String](CRMScript.Global.String) - When emails are sent (offer or confirmation), a language can be chosen in the GUI; this field saves the most recent choice and can be used to default the next such choice. Default-default is user's current language.

**Example:**

```crmscript
NSQuote thing;
String preferredEmailCulture = thing.GetPreferredEmailCulture();
```

## GetQuoteConnectionId()

```crmscript
Integer GetQuoteConnectionId()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - The connection in the CRM system to where this quote came from. Identifies the ERP connection used for this quote. Each quote is bound to one and only one connection.

**Example:**

```crmscript
NSQuote thing;
Integer quoteConnectionId = thing.GetQuoteConnectionId();
```

## GetQuoteId()

```crmscript
Integer GetQuoteId()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - Primary key.

**Example:**

```crmscript
NSQuote thing;
Integer quoteId = thing.GetQuoteId();
```

## GetSaleId()

```crmscript
Integer GetSaleId()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - The foreign key to the corresponding sale.

**Example:**

```crmscript
NSQuote thing;
Integer saleId = thing.GetSaleId();
```

## GetUseValuesFromQuote()

```crmscript
Integer GetUseValuesFromQuote()
```

**Returns:** [CRMScript.Global.Integer](CRMScript.Global.Integer) - If true, then the Earning, Earning_Percent and Amount fields are populated from the QuoteVersion.QuoteAlternative (current revision, most-likely alternative).

**Example:**

```crmscript
NSQuote thing;
Integer useValuesFromQuote = thing.GetUseValuesFromQuote();
```

## SetAcceptedQuoteAlternativeId(Integer)

```crmscript
Void SetAcceptedQuoteAlternativeId(Integer acceptedQuoteAlternativeId)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

<Note>
Set when the user is marking a quote as accepted.
</Note>

**Example:**

```crmscript
NSQuote thing;
Integer acceptedQuoteAlternativeId;
thing.SetAcceptedQuoteAlternativeId(acceptedQuoteAlternativeId);
```

## SetActiveQuoteVersion(NSQuoteVersion)

```crmscript
Void SetActiveQuoteVersion(NSQuoteVersion activeQuoteVersion)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
NSQuoteVersion activeQuoteVersion;
thing.SetActiveQuoteVersion(activeQuoteVersion);
```

## SetActiveQuoteVersionId(Integer)

```crmscript
Void SetActiveQuoteVersionId(Integer activeQuoteVersionId)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

<Note>
The active version will always be the latest version.
</Note>

**Example:**

```crmscript
NSQuote thing;
Integer activeQuoteVersionId;
thing.SetActiveQuoteVersionId(activeQuoteVersionId);
```

## SetDocumentId(Integer)

```crmscript
Void SetDocumentId(Integer documentId)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
Integer documentId;
thing.SetDocumentId(documentId);
```

## SetERPOrderKey(String)

```crmscript
Void SetERPOrderKey(String eRPOrderKey)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
String eRPOrderKey;
thing.SetERPOrderKey(eRPOrderKey);
```

## SetERPQuoteKey(String)

```crmscript
Void SetERPQuoteKey(String eRPQuoteKey)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
String eRPQuoteKey;
thing.SetERPQuoteKey(eRPQuoteKey);
```

## SetFavoriteQuoteAlternative(NSQuoteAlternative)

```crmscript
Void SetFavoriteQuoteAlternative(NSQuoteAlternative favoriteQuoteAlternative)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
NSQuoteAlternative favoriteQuoteAlternative;
thing.SetFavoriteQuoteAlternative(favoriteQuoteAlternative);
```

## SetOrderComment(String)

```crmscript
Void SetOrderComment(String orderComment)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
String orderComment;
thing.SetOrderComment(orderComment);
```

## SetPoNumber(String)

```crmscript
Void SetPoNumber(String poNumber)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
String poNumber;
thing.SetPoNumber(poNumber);
```

## SetPreferredEmailCulture(String)

```crmscript
Void SetPreferredEmailCulture(String preferredEmailCulture)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
String preferredEmailCulture;
thing.SetPreferredEmailCulture(preferredEmailCulture);
```

## SetQuoteConnectionId(Integer)

```crmscript
Void SetQuoteConnectionId(Integer quoteConnectionId)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
Integer quoteConnectionId;
thing.SetQuoteConnectionId(quoteConnectionId);
```

## SetQuoteId(Integer)

```crmscript
Void SetQuoteId(Integer quoteId)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
Integer quoteId;
thing.SetQuoteId(quoteId);
```

## SetSaleId(Integer)

```crmscript
Void SetSaleId(Integer saleId)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
Integer saleId;
thing.SetSaleId(saleId);
```

## SetUseValuesFromQuote(Integer)

```crmscript
Void SetUseValuesFromQuote(Integer useValuesFromQuote)
```

**Returns:** [CRMScript.Global.Void](CRMScript.Global.Void)

**Example:**

```crmscript
NSQuote thing;
Integer useValuesFromQuote;
thing.SetUseValuesFromQuote(useValuesFromQuote);
```
